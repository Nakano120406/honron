# はじめに
ユーザーがネットワーク通信品質を調べるために，一般にWebベースのスピードテストサイトが用いられる．このようなサイトは多数運用されており，計測結果を統計情報の掲載やインターネットの通信品質の分析などに活用されている．しかし，通信品質において，アクセス網の種類やインターネット接続方式などのアクセス環境が通信品質にどのように影響を与えるかについては，詳細な情報が提供されていない．
本研究では，アクセス環境による通信品質の影響を明らかにするために，アクセス環境による通信品質の違いを調査査し，IPv4とIPv6の比較の観点から分析する．それにより，アクセス環境の違いによる分析の意義を示す．また，通信品質の違いを可視化するシステムを開発し，アクセス環境による通信品質の違いをユーザーに直感的に理解できるようにする．
# アクセス環境の通信品質への影響

## 調査方法
本研究ではアクセス環境として，インターネットサービスプロバイダ（ISP）の網，FTTHやCATVなどのアクセス回線の種類，IPoE等のインターネット接続方式を対象として通信品質を調査する．iNoniusスピードテストの計測ログを用いる．計測ログには，計測日時，ISP，スループット，RTT，MSSなどの情報が含まれている．分析の対象としたデータの計測期間は2022年10月1日〜2023年5月31日と2023年6月1日〜2024年6月31日までで，このうち，IPv4/IPv6デュアルスタック環境におけるアップロードとダウンロースのスループットデータを使用する．ISPの判定にはiNoniusスピードテストで使用しているLibreSpeedが問い合わせをするipinfo.ioのデータを，アクセス網の判定にはGeoLocationTechnologyが提供する「どこどこJP」を使用した．インターネット接続方式の判定には，計測ログに含まれるMSSの値を用いて，先行研究と同様に判定した．対象データをIPv4/IPv6で使用したISP，アクセス網の3種類(FTTH，CATV，Mobile)，インターネット接続方式(IPoE，PPPoE)ごとに集計し，傾向を調べることによってアクセス環境の違いを分析する．

## 調査結果
アクセス環境の違いによる8種類の集計結果をIPv4とIPv6のスループットの比較わかるように散布図とヒストグラムのグラフにした．図1はIPv4とIPv6のダウンロードのスループットのグラフである．(a)がIPv4とIPv6ともにIPoEで，(b)がPPPoEで接続した場合を示す．左下がIPv4とIPv6のスループットの相関を示す散布図で，左上と右下のヒストグラムがそれぞれIPv4とIPv6のスループットの階級ごとの度数を表す．両者を比較すると，(b)のPPPoEの場合のほうがスループットの平均値が高く，ヒストグラムの分布も高い値に集まる傾向が見られた．その他，IPv4/IPv6で使用したISPの違いによって，IPv4/IPv6の相関性が異なることが分かった．また，3つのアクセス網の違いによってスループットの限界に異なることがわかった．一方，RTTに関しては，FTTHに比べMobileの方が平均値が高く，分布も高い位置に集中していたが，そのほかのアクセス環境の違いによって，傾向に大きな違いは見られなかった．

## 考察
調査，分析を通して，インターネットの通信品質の指標としてスループットを対象にした場合，ISP，アクセス回線やインターネット接続方式などアクセス環境の違いによって，平均値や分布のふるまいが異なることがわかった．この傾向の違いをインターネットのスピードテストの計測結果の判断に反映できれば，利用者のアクセス環境に近い環境において自身の結果の良し悪しを判断できるようになる．

# アクセス環境の可視化システム
2章の結果を踏まえて，アクセス環境によるスループットの違いをユーザーに直感的に理解できるようにするために，iNoniusスピードテストの計測ログの統計情報を可視化するシステムを開発し，可視化サイトを開設した．図2にシステム構成を示す．iNoniusスピードテストサーバーから，毎月の計測ログを取得し，データ処理コンテナでアクセス環境ごとに最大値，最小値，中央値，四分位範囲，平均値からなる統計情報を算出し，統計量記録用テーブルに保存する．統計量記録用テーブルから1年分の統計量を取得して，表示用の画像を作成して，グラフ画像記録用テーブルにバイナリデータとして保存する．クライアントからのアクセス環境ごとの集計結果の要求をWebサーバーコンテナを受け取ると画像生成コンテナを経由して，グラフ画像記録用テーブルからバイナリデータを取得後，要求に対応する1年分の集計結果のグラフを画像（JPEG）ファイルとしてクライアントに返す．図3はアクセス回線がCATVの場合のIPv6のダウンロードスループットのグラフである．可視化サイトにはアクセス環境ごとにIPv4とIPv6，ダウンロードとアップロードのスループットをそれぞれ示す4つのグラフが表示される．

このサイトはhttps://inonius.v6.netsci.info.hiroshima-cu.ac.jp/で公開している．このサイトを利用したユーザーに実施したアンケートをもとに評価を行う．アクセス環境ごとの統計情報を可視化することに対して，約73.3\%のユーザーが意義があると肯定的な回答をしている．一方，グラフとして箱ひげ図は，わかりにくく適切でないという回答が全体の3分の1を占めた．自由記述の欄には，縦軸のスケールがばらばらであることによって比較が難しいことなどが指摘されている．この結果を受け，スピードテストサイトの結果をアクセス環境ごとに可視化することは，ユーザーにとっても有用であることが示された一方，表現の方法については改善の余地があることがわかった．

# まとめ
本研究では，アクセス環境による通信品質の違いをスピードテストサイトによって調査し，アクセス環境による通信品質への影響があることを明らかにした．アクセス環境によって，スループットとRTTの平均値や分布のふるまいが異なることがわかり，アクセス環境の影響に注意をして計測結果の考察や，計測ログの分析をする必要があることが示された．また，通信品質の違いを可視化し，ユーザーに通信品質の違いを直感的に理解できるシステムをした．ユーザーからのアンケート結果には，統計情報の表示方法について改善の余地はあるが，統計情報を表示することの意義やアクセス環境ごとに統計をとることに対して肯定的な意見が多くあったことから，アクセス環境による影響を可視化する意義があると考えるある．

今後の課題は，対象とするアクセス環境の種類を増やし，さらに詳細な分析を行うことである．